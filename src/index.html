<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Projet</title>
  <link rel="stylesheet" href="assets/css/reset.css">
  <link rel="stylesheet" href="assets/css/styles.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
</head>

<body>



  <ul class="arbo">

    <li>

      <div id="div1">PDG</div>
      <ul>
        <li>
          <div id="div2">Assistante</div>
        </li>
        <li>
          <div>Directeur financier</div>
          <ul>
            <li>
              <div>Comtable 1</div>
            </li>
            <li>
              <div>Comtable 2</div>
              <ul>
                <li>
                  <div>Stagiaire</div>
                </li>
              </ul>
            </li>
          </ul>
        </li>
        <li>
          <div>Directeur commercial</div>
          <ul>
            <li>
              <div>Manager 1</div>
              <ul>
                <li>
                  <div>Vendeur 1</div>
                </li>
                <li>
                  <div>Vendeur 2</div>
                  <ul>
                    <li>
                      <div>Stagiaire</div>
                    </li>
                    <li>
                      <div>Stagiaire</div>
                    </li>
                  </ul>
                </li>
              </ul>
            </li>
            <li>
              <div>Manager 2</div>
              <ul>
                <li>
                  <div>Vendeur 3</div>
                </li>
                <li>
                  <div>Vendeur 4</div>
                </li>
                <li>
                  <div>Vendeur 5</div>
                </li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>


  <script>
    document.body.onload = createLines;

    function createLines() {
      var arbo = document.querySelector(".arbo")
      var wrapper =  document.createElement('div')
      wrapper.setAttribute("class","wrapper")
      arbo.parentNode.insertBefore(wrapper, arbo)
      wrapper.appendChild(arbo)
      let viewBox = `0 0 ${arbo.getBoundingClientRect().width} ${arbo.getBoundingClientRect().height}`
      var svg = document.createElementNS("http://www.w3.org/2000/svg","svg")     
      svg.setAttribute("viewBox", viewBox);
      wrapper.prepend(svg); 
      let elements = document.querySelectorAll(':not(.arbo) > li > *:not(ul)')
      elements.forEach(elem => {
        const parent = elem.parentElement.parentElement.parentElement.firstElementChild;
        const ul = elem.parentElement.parentElement;
        var g = document.createElementNS("http://www.w3.org/2000/svg", "g");


        for (let index = 0; index < 3; index++) {
          var line = document.createElementNS("http://www.w3.org/2000/svg","line");
          line.setAttribute("stroke", "red");
          console.log(elem.parentElement.parentElement.parentElement.firstElementChild);
          var div1Rect = parent.getBoundingClientRect();
          var div2Rect = elem.getBoundingClientRect();
          if (index === 0) {
            line.setAttribute('x1', div1Rect.left + (div1Rect.width / 2));
            line.setAttribute('x2', div1Rect.left + (div1Rect.width / 2));
            line.setAttribute('y1', div1Rect.top + div1Rect.height)
            line.setAttribute('y2', div1Rect.top + div1Rect.height + (div2Rect.top - div1Rect.top - div1Rect
              .height) / 2);
          }
          if (index === 1) {
            line.setAttribute('x1', div1Rect.left + (div1Rect.width / 2));
            line.setAttribute('x2', div2Rect.left + (div2Rect.width / 2));
            line.setAttribute('y1', div1Rect.top + div1Rect.height + (div2Rect.top - div1Rect.top - div1Rect.height) / 2);
            line.setAttribute('y2', div1Rect.top + div1Rect.height + (div2Rect.top - div1Rect.top - div1Rect
              .height) / 2);
          }
          if (index === 2) {
            line.setAttribute('x1', div2Rect.left + (div2Rect.width / 2));
            line.setAttribute('x2', div2Rect.left + (div2Rect.width / 2));
            line.setAttribute('y1', div1Rect.top + div1Rect.height + (div2Rect.top - div1Rect.top - div1Rect.height) / 2);
            line.setAttribute('y2', div2Rect.top);
          }
          console.log(index)
          g.appendChild(line);
        }
        svg.appendChild(g);
      });
    }
    
      
  </script>

</body>

</html>